---
layout: post
title: Rust the book -- 02 Common Programming Concepts
date: 21-09-02 20:00:40 +0800
categories: rust
---

[TOC]

<a name="Top"></a>

# Rust å­¦ä¹  - 02

## ç¬¬3ç« ï¼šCommon Programming Concepts

è¿™ä¸€ç« å°±ä»‹ç»äº†Rustä¸­çš„ä¸€äº›å’Œå…¶ä»–è¯­è¨€ä¸€æ ·çš„ç‰¹æ€§åœ¨Rustä¸­æ˜¯å¦‚ä½•è¡¨ç°çš„ã€‚

åœ¨æœ¬ä¹¦çš„[é™„å½•A](https://doc.rust-lang.org/book/appendix-01-keywords.html)ä¸­åŒ…å«Rustä½¿ç”¨çš„æ‰€æœ‰å…³é”®å­—ã€‚



---

### 1. å˜é‡

#### 1.2 å˜é‡ä¸å¯å˜æ€§

Rustçš„å˜é‡æ˜¯é»˜è®¤ä¸å¯å˜çš„ï¼Œä½†ä¹Ÿèƒ½é€‰æ‹©è®©å˜é‡å¯å˜ï¼Œè¿™ä¸€èŠ‚ä¼šè¯´æ˜ä¸å¯å˜çš„å¥½å¤„ä»¥åŠä½•æ—¶åº”è¯¥è®©å®ƒå¯å˜ã€‚

å¦‚æœè¯•å›¾ç»™ä¸€ä¸ªä¸å¯å˜çš„å˜é‡é‡æ–°èµ‹å€¼ï¼š

```rust
fn main() {
    let x = 5;
    println!("The value of x is: {}", x);
    x = 6;
    println!("The value of x is: {}", x);
}
```

å°±ä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘å™¨æŠ¥é”™ï¼š`cannot assign twice to immutable variable`

åœ¨ä¸€ä¸ªä¸å¯å˜çš„å˜é‡è¢«è¯•å›¾æ”¹å˜æ—¶æŠ¥é”™ï¼Œå¯ä»¥é¿å…ç¨‹åºçš„ä¸€äº›Bugã€‚æ¯”å¦‚åœ¨ä»£ç æ®µAä¸­å‡è®¾å˜é‡çš„ä¸å˜çš„ï¼Œä½†åœ¨ä»£ç æ®µBä¸­å´æ”¹å˜äº†è¿™ä¸ªå˜é‡ï¼Œè¿™å°±å¯èƒ½å¯¼è‡´ä»£ç æ®µAå‡ºç°BUGï¼Œè¿™æ ·çš„Bugå¾ˆéš¾è¢«è¿½è¸ªï¼Œå°¤å…¶æ˜¯åœ¨ä»£ç æ®µBåªæ˜¯æœ‰æ—¶ä¼šæ”¹å˜è¿™ä¸ªå˜é‡æ—¶ã€‚



#### 2.2 å˜é‡å’Œå¸¸é‡çš„åŒºåˆ«

ä¸å¯å˜çš„å˜é‡ä¸å¸¸é‡éå¸¸åƒï¼Œä½†æ˜¯äºŒè€…æ˜¯ä¸åŒçš„ï¼šå¸¸é‡æ°¸è¿œæ˜¯ä¸å¯å˜çš„ï¼Œè€Œå˜é‡ä»…ä»…æ˜¯é»˜è®¤ä¸å¯å˜ã€‚

1. ä½¿ç”¨`const`å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªå¸¸é‡ï¼ŒåŒæ—¶å¿…é¡»å£°æ˜å¸¸é‡çš„ç±»å‹ï¼›
2. å¸¸é‡å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«å£°æ˜ï¼›
3. Rustçš„å¸¸é‡å‘½åé£æ ¼æ˜¯ï¼šå…¨å¤§å†™ï¼Œç”¨ä¸‹åˆ’çº¿åˆ†å‰²å•è¯`const MAX_POINTS: u32 = 100_000;`ï¼ŒåŒæ—¶æ•°å­—å¯ä»¥ç”¨ä¸‹åˆ’çº¿åˆ†å‰²æ¥æé«˜å¯è¯»æ€§ï¼›
4. å¸¸é‡çš„å£°æ˜å‘¨æœŸæ˜¯æ•´ä¸ªä»£ç å—ã€‚



#### 2.3 Shadowing

å¯ä»¥å¯¹ä¸€ä¸ªå·²ç»å£°æ˜çš„immutableå˜é‡ä¿®æ”¹å†…å®¹ã€‚

```rust
let x = 5;
let x = x + 1;
let x = x * 3;
```

`Shadowing`å¯ä»¥é‡å¤ä½¿ç”¨ä¸€ä¸ªå˜é‡åï¼ŒåŒæ—¶æ”¹å˜è¿™ä¸ªå˜é‡çš„ç±»å‹ï¼Œè¿™ä¸€ç‚¹æ¯”`mut`æ›´å¥½ï¼Œå› ä¸º`mut`åœ¨éœ€è¦åŒä¸€ä¸ªå˜é‡çš„ä¸åŒå˜é‡ç±»å‹çš„æ—¶å€™å¿…é¡»é‡æ–°å£°æ˜ä¸€ä¸ªã€‚



---

### 2. æ•°æ®ç±»å‹

Rustä¸­æ¯ä¸€ä¸ªå˜é‡éƒ½æœ‰ä¸€ä¸ªç¡®å®šçš„ç±»å‹ï¼ˆå¼ºç±»å‹è¯­è¨€ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä¸»è¦çœ‹ä¸¤ç§æ•°æ®ç±»å‹é›†ã€‚Scalarå’ŒCompoundã€‚

åŒæ—¶Rustè¿˜æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„ç±»å‹å¿…é¡»è¦ç¼–è¯‘æœŸå°±è¢«ç¡®å®šã€‚æ‰€ä»¥åœ¨åšç±»å‹è½¬æ¢æ—¶ï¼Œå¿…é¡»å‘Šè¯‰ç¼–è¯‘å™¨è¦è½¬æ¢çš„ç›®æ ‡ç±»å‹ã€‚



#### 2.1 Scalar Types

`Scalar`ç±»å‹è¡¨ç¤ºäº†ä¸€ä¸ªå•å€¼ï¼ŒRustæœ‰å››ç§`Scalar`ç±»å‹ï¼š`integers` `floating-point numbers` `Booleans` `characters`ã€‚



##### 2.1.1 Integers

æ•´å‹ï¼ŒRusté‡Œé¢æœ‰ä»¥ä¸‹è¿™äº›æ•´å‹ï¼š

| Length  | Signed | Unsigned |
| ------- | ------ | -------- |
| 8-bit   | i8     | u8       |
| 16-bit  | i16    | u16      |
| 32-bit  | i32    | u32      |
| 64-bit  | i64    | u64      |
| 128-bit | i128   | u128     |
| arch    | isize  | usize    |

nä½æœ‰ç¬¦å·æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´æ˜¯ï¼š\[ -2^n-1^, 2^n-1^ - 1 \]

nä½æ— ç¬¦å·æ•´æ•°çš„è¡¨ç¤ºèŒƒå›´æ˜¯ï¼š[ 0, 2^n^ - 1 ]

`isize`å’Œ`usize`ç±»å‹çš„é•¿åº¦ç”±ç¨‹åºæ‰€è¿è¡Œçš„è®¡ç®—æœºæ¶æ„å†³å®šï¼Œ32ä½è®¡ç®—æœºå³i32ï¼Œ64ä½å°±æ˜¯i64

| Number literals  | Example     |
| ---------------- | ----------- |
| Decimal          | 98_222      |
| Hex              | 0xff        |
| Octal            | 0o77        |
| Binary           | 0b1111_0000 |
| Byte (`u8` only) | b'A'        |

Rustä¼šå¤„ç†æ•´æ•°æº¢å‡ºï¼Œå½“ç¨‹åºåœ¨Debugæ¨¡å¼ç¼–è¯‘å¹¶åœ¨è¿è¡Œæ—¶å‡ºç°æ•´æ•°æº¢å‡ºæ—¶ï¼Œä¼šå¯¼è‡´ç¨‹åº`panic`ã€‚å½“ç¨‹åºç¼–è¯‘æ—¶ä½¿ç”¨äº†`--release`é€‰é¡¹ï¼ŒRustå°±ä¸ä¼šå†æ£€æŸ¥æ•´æ•°æº¢å‡ºï¼Œè€Œæ˜¯ä¼šå°†æº¢å‡ºçš„éƒ¨åˆ†æˆªæ–­ã€‚æ¯”å¦‚u8ç±»å‹å­˜å‚¨äº†257ï¼Œæº¢å‡ºåå˜ä¸º1ã€‚ï¼ˆWrappingï¼‰

Rustå¯ä»¥æ˜¾å¼åœ°å¤„ç†æº¢å‡ºï¼š

- ä½¿ç”¨`wrapping_*`æ–¹æ³•ï¼›
- ä½¿ç”¨`checked_*`æ–¹æ³•ï¼Œ å¦‚æœæ²¡æœ‰æº¢å‡ºï¼Œå°†è¿”å›`None`ï¼›
- ä½¿ç”¨`overflowing_*`æ–¹æ³•ï¼Œå°†è¿”å›å€¼ä»¥åŠä¸€ä¸ªBooleanæ¥è¡¨ç¤ºæ˜¯å¦æº¢å‡ºï¼›
- ä½¿ç”¨`saturating_*`æ–¹æ³•ï¼Œå°†ä¸è¿›è¡Œwrappingï¼Œè€Œæ˜¯è¿”å›æ•°æ®ç±»å‹çš„æœ€å¤§ã€æœ€å°å€¼ã€‚



##### 2.1.2 Floating-Point

Rustæœ‰ä¸¤ç§æµ®ç‚¹æ•°ï¼šf32, f64ã€‚é»˜è®¤ç±»å‹æ˜¯f64ï¼Œå› ä¸ºç°ä»£CPUåœ¨è®¡ç®—32ä½å’Œ64ä½æµ®ç‚¹æ•°æ—¶æ•ˆç‡æ˜¯ä¸€æ ·çš„ã€‚



##### 2.1.3 æ•°å­—å¤„ç†

Rustæ”¯æŒå¯¹æ•°å­—ç±»å‹çš„åŸºæœ¬è®¡ç®—æ“ä½œï¼ˆåŠ å‡ä¹˜é™¤æ±‚ä½™ï¼‰ã€‚

```rust
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;

    // remainder
    let remainder = 43 % 5;
}
```



##### 2.1.4 Boolean

ä¿©å€¼ï¼š`true` `false`å’ŒC++ä¸€æ ·æ˜¯å…¨å°å†™ã€‚

```rust
fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}
```



##### 2.1.5 Character

Rustçš„å­—ç¬¦ç±»å‹ä½¿ç”¨å•å¼•å·ï¼Œå­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·ã€‚

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
}

```

Rustçš„å­—ç¬¦é•¿åº¦æ˜¯4ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”ä½¿ç”¨Unicodeç¼–ç ï¼Œè¿™æ„å‘³è¿™å¯ä»¥ä½¿ç”¨æ¯”ASCIIæ›´å¤šçš„å­—ç¬¦ã€‚

[ç¬¬8ç« ](https://doc.rust-lang.org/book/ch08-02-strings.html#storing-utf-8-encoded-text-with-strings)è¿˜ä¼šè¯¦ç»†è®¨è®ºRustä¸­çš„å­—ç¬¦ä¸²ã€‚



#### 2.2 Compound Typesï¼ˆç»„åˆç±»å‹ï¼‰

Rustæœ‰ä¸¤ç§åŸºæœ¬ç»„åˆç±»å‹ï¼štupleså’Œarrays



##### 2.2.1 Tuple å…ƒç»„

tupleå¯ä»¥å°†ä¸€äº›ä¸åŒç±»å‹ï¼ˆæˆ–åŒä¸€ç±»å‹ï¼‰çš„å˜é‡ç»„åˆè¿›ä¸€ä¸ªç»„åˆç±»å‹ã€‚tupleæœ‰å›ºå®šé•¿åº¦ï¼Œåœ¨å£°æ˜æ—¶ç¡®å®šï¼Œä¸å¯ä»¥å¢å‡ã€‚tupleä¸­çš„å…ƒç´ ç”¨é€—å·åˆ†éš”å¼€ï¼Œå¹¶ç”¨å°æ‹¬å·åŒ…è£¹ã€‚

tupleçš„å£°æ˜å¦‚ä¸‹ï¼Œç±»å‹å¯ä»¥ä¸ä¸€è‡´ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}

```

ç”¨ä»¥ä¸‹çš„æ–¹æ³•å¯ä»¥destructureä¸€ä¸ªtuple

```rust
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of y is: {}", y);
}
```

ä¸Šé¢çš„è¿™ç§æ–¹æ³•æŠŠä¸€ä¸ªtupleå˜æˆäº†è‹¥å¹²ä¸ªå•ä¸ªå˜é‡ï¼Œç§°ä¸º`destructuring`ã€‚

é™¤äº†destructuringï¼Œè¿˜å¯ä»¥é€šè¿‡`.`è®¿é—®tupleä¸­çš„å…ƒç´ ï¼š

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}

```

ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡æ˜¯0



##### 2.2.2 Array æ•°ç»„

æ•°ç»„ä¸­çš„å…ƒç´ å¿…é¡»éƒ½æ˜¯åŒä¸€ç§ç±»å‹ã€‚Rustä¸­çš„æ•°ç»„å’ŒæŸäº›è¯­è¨€ä¸­ä¸å¤ªä¸€æ ·ï¼Œå®ƒä¹Ÿæ˜¯å’Œå…ƒç»„ä¸€æ ·å›ºå®šé•¿åº¦ã€‚

æ•°ç»„ä¸­çš„å…ƒç´ ç”¨é€—å·åˆ†éš”ï¼Œå¹¶ç”¨ä¸­æ‹¬å·åŒ…è£¹ã€‚

````rust
fn main() {
    let a = [1, 2, 3, 4, 5];
}

````

å¦‚æœä½ æƒ³æŠŠæ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šè€Œä¸æ˜¯å †ä¸Šæ—¶ï¼Œåº”è¯¥ä½¿ç”¨æ•°ç»„ã€‚ç¬¬4ç« ä¼šä»”ç»†è®¨è®ºæ ˆå’Œå †ã€‚

Arrayæ²¡æœ‰vectorçµæ´»ï¼Œvectorå¯ä»¥å˜é•¿å˜çŸ­ï¼Œåœ¨æ ‡å‡†åº“ä¸­æä¾›ã€‚å¦‚æœä½ ä¸ç¡®å®šè¯¥ä½¿ç”¨Arrayæˆ–Vectorï¼Œé‚£ä¹ˆä½ å¤§æ¦‚éœ€è¦vectorã€‚ç¬¬8ç« ä¼šä»”ç»†è®¨è®ºvectorã€‚

å½“ä½ æƒ³è¦å­˜å‚¨ä¸€äº›ä¸€å®šå›ºå®šä¸å˜çš„æ•°æ®æ—¶ï¼ˆä¸€å¹´12ä¸ªæœˆçš„åç§°ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨Arrayã€‚

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

åœ¨ä¸­æ‹¬å·ä¸­æŒ‡å®šArrayçš„ç±»å‹å·²ç»å…ƒç´ ä¸ªæ•°ã€‚

å¦‚æœæƒ³ç”¨ç›¸åŒçš„å€¼åˆå§‹åŒ–ä¸€ä¸ªArrayï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¡¨è¾¾å¼ï¼š

```rust
let a = [3; 5];
```

è¿™ä¸ªè¡¨è¾¾å¼ä¼šåˆ›å»ºä¸€ä¸ªæœ‰5ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ çš„å€¼éƒ½æ˜¯3ã€‚

å¯ä»¥ä½¿ç”¨ä¸‹æ ‡è®¿é—®æ•°ç»„å…ƒç´ ã€‚

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];
    let second = a[1];
}

```

å¦‚æœæ•°ç»„è®¿é—®å‡ºç°è¶Šç•Œï¼Œä¼šæŠ¥é”™ï¼š`index out of bounds`ï¼ŒåŒæ—¶ç¨‹åºä¼španicã€‚

```rust
use std::io;

fn main() {
    let a = [1, 2, 3, 4, 5];

    println!("Please enter an array index.");

    let mut index = String::new();

    io::stdin()
        .read_line(&mut index)
        .expect("Failed to read line");

    let index: usize = index
        .trim()
        .parse()
        .expect("Index entered was not a number");

    let element = a[index];

    println!(
        "The value of the element at index {} is: {}",
        index, element
    );
}

```



è¿™æ˜¯Rustçš„å®‰å…¨åŸåˆ™ï¼Œä¿è¯äº†æ•°ç»„ä¸èƒ½è¶Šç•Œè®¿é—®ã€‚



---

### 3. å‡½æ•°

Rustç”¨`fn`å£°æ˜å‡½æ•°ï¼ŒåŒæ—¶å‡½æ•°å‘½åéµå¾ª`Snake`åŸåˆ™ï¼Œå…¨éƒ¨å°å†™ï¼Œç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ã€‚

```rust
fn main() {
    println!("Hello, world!");

    another_function();
}

fn another_function() {
    println!("Another function.");
}

```

#### 3.1 å‡½æ•°å‚æ•°

åœ¨mainå‡½æ•°ä¹‹åå£°æ˜çš„å‡½æ•°ä¹Ÿå¯ä»¥è¢«mainè°ƒç”¨ï¼ŒRustä¸åœ¨æ„ä¸€ä¸ªå‡½æ•°åœ¨å“ªé‡Œè¢«å£°æ˜ï¼Œåªåœ¨æ„ä¸€ä¸ªå‡½æ•°æ˜¯ä¸æ˜¯åœ¨æŸå¤„è¢«å£°æ˜ã€‚ä¸€èˆ¬å‡½æ•°æ‹¥æœ‰å‚æ•°è¡¨ï¼ˆparameterï¼‰ï¼Œè¿™æ˜¯å‡½æ•°çš„å±æ€§ï¼Œè€Œä¼ å…¥å‡½æ•°çš„æ•°æ®ç§°ä¸º`arguments`ï¼Œä½†æ˜¯äººä»¬ä¹Ÿä¼šæ··ç”¨è¿™ä¸¤ä¸ªå•è¯ã€‚

```rust
fn main() {
    another_function(5);
}

fn another_function(x: i32) {
    println!("The value of x is: {}", x);
}

```

åœ¨å‡½æ•°çš„å‚æ•°è¡¨ä¸­ï¼Œå¿…é¡»å£°æ˜æ¯ä¸ªå‚æ•°çš„**ç±»å‹**ã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚æœæƒ³ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œå°†å‚æ•°ä½¿ç”¨é€—å·åˆ†éš”ã€‚

```rust
fn rust_add(x: i32, y: i32) {
    println!("x + y = {}", x + y);
}
```



#### 3.2 å«æœ‰è¡¨è¾¾å¼å’Œå£°æ˜çš„å‡½æ•°ä½“

**å£°æ˜ï¼ˆStatementï¼‰**ï¼šæ‰§è¡Œä¸€äº›å·¥ä½œï¼Œä½†ä¸è¿”å›å€¼çš„è¯­å¥ï¼›

**è¡¨è¾¾å¼ï¼ˆExpressionï¼‰**ï¼šæ±‚ä¸€ä¸ªç»“æœå€¼ã€‚

##### 3.2.1 **å£°æ˜**ï¼š

1. ä½¿ç”¨`let`åˆ›å»ºä¸€ä¸ªå˜é‡å¹¶èµ‹å€¼æ˜¯ä¸€ä¸ªå£°æ˜ï¼ˆStatementï¼‰ï¼›
2. å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯ä¸€ä¸ªå£°æ˜ã€‚

```rust
fn main() {
	let x = 6;
}
```

å£°æ˜æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨äº`let`çš„å³å€¼ã€‚ä¸‹é¢çš„ä»£ç æ˜¯é”™è¯¯çš„ï¼š

```rust
fn main() {
	let x = (let y = 0);
}
```

æ‰€ä»¥åœ¨Rustä¸­ä¸èƒ½ä½¿ç”¨ç±»ä¼¼äº`x = y = 1`è¿™æ ·çš„è¯­å¥æ¥ä½¿xyéƒ½ç­‰äº1ã€‚



##### 3.2.2 è¡¨è¾¾å¼ï¼š

1. ä¸€ä¸ªæ•°å­¦è®¡ç®—å¼æ˜¯è¡¨è¾¾å¼`3 + 2`ï¼›
2. è°ƒç”¨å‡½æ•°æ˜¯ä¸€ç§è¡¨è¾¾å¼ï¼›
3. è°ƒç”¨å®æ˜¯ä¸€ç§è¡¨è¾¾å¼ï¼›
4. ç”¨å¤§æ‹¬å·åŒ…è£¹çš„ä»£ç å—ï¼Œç”¨äºäº§ç”Ÿä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸçš„ä»£ç ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚

```rust
fn main() {
    let x = 5;

    let y = {
        let x = 3;
        x + 1
    }; // è¿™é‡Œçš„å¤§æ‹¬å·è¿”å› x + 1çš„å€¼

    println!("The value of y is: {}", y);
}

```

è¡¨è¾¾å¼å¯ä»¥æ˜¯å£°æ˜çš„ä¸€éƒ¨åˆ†ã€‚

è¡¨è¾¾å¼ä¸åŒ…æ‹¬å°¾éƒ¨çš„åˆ†å·`;`ï¼Œå¦‚æœä¸Šé¢çš„å¤§æ‹¬å·ä¸­çš„`x + 1`å°¾éƒ¨å¸¦æœ‰åˆ†å·ï¼Œå®ƒå°±ä¸ä¼šå†è¿”å›ä¸€ä¸ªå€¼äº†ï¼ŒåŒæ—¶ä¸Šé¢çš„ä»£ç ä¼šåœ¨`println`å¤„æŠ¥é”™ã€‚



#### 3.3 å¸¦æœ‰è¿”å›å€¼çš„å‡½æ•°

å‡½æ•°å¯ä»¥ç»™è°ƒç”¨å®ƒçš„ä»£ç è¿”å›å€¼ï¼Œæˆ‘ä»¬ä¸ä¼šå¯¹è¿”å›å€¼è¿›è¡Œå‘½åï¼Œä½†ä¼šä½¿ç”¨ç®­å¤´`->`å£°æ˜è¿”å›å€¼çš„ç±»å‹ã€‚

è¿”å›å€¼å¯ä»¥æ˜¯å‡½æ•°ä½“ä¸­ä½¿ç”¨`return`å…³é”®å­—è¿”å›çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ä½“ä¸­çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆä¸è¦åŠ åˆ†å·ï¼‰ï¼ˆä½¿ç”¨æ›´å¤šï¼‰ã€‚

```rust
fn foo_return_23() -> i32 {
    23
}

fn foo_use_return() -> i32 {
    let x = 2;
    let y = 4;
    return x | y;
}
```

å¦‚æœç»™23åŠ ä¸Šåˆ†å·ï¼Œå°±ä¼šå¾—åˆ°æŠ¥é”™ï¼š`mismatched types`

å£°æ˜ä¸ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œè¿™åœ¨Rustä¸­è¢«è¡¨è¾¾ä¸ºä¸€ä¸ªç©ºçš„ tuple `()`ï¼Œè¿™ä¸å‡½æ•°è¿”å›å€¼å®šä¹‰çš„`i32`å†²çªã€‚



---

### 4. æ³¨é‡Š

Rustä½¿ç”¨ä¸¤ä¸ªæ–œæ å¼€å¤´ä½œä¸ºæ³¨é‡Š`//`ï¼Œå¤šè¡Œæ³¨é‡Šéœ€è¦åœ¨æ¯è¡Œå‰é¢ä½¿ç”¨ä¸¤ä¸ªæ–œæ ã€‚

Rustä¹ æƒ¯äºå°†æ³¨é‡Šæ”¾åœ¨å®ƒæ‰€è§£é‡Šçš„ä»£ç ä¸Šæ–¹ã€‚

Rustè¿˜æœ‰å¦ä¸€ç§æ³¨é‡Šï¼šæ–‡æ¡£æ³¨é‡Šï¼Œåœ¨ç¬¬14ç« ä¸­ä¼šè®¨è®ºã€‚



---

### 5. æ§åˆ¶æµ

#### 5.1 ifè¡¨è¾¾å¼

Rustçš„ifå¦‚ä¸‹ï¼Œä¸ä½¿ç”¨å°æ‹¬å·ï¼š

```rust
fn main() {
    let number = 3;

    if number < 5 {
        println!("condition was true");
    } else {
        println!("condition was false");
    }
}

```

ifçš„å‡½æ•°å—ï¼ˆ`{}`ä¸­çš„éƒ¨åˆ†ï¼‰ï¼Œæœ‰æ—¶è¢«ç§°ä¸º`arms`ï¼Œå’Œä¹‹å‰è®¨è®ºè¿‡çš„`match`è¡¨è¾¾å¼ä¸­çš„`arms`ä¸€æ ·ã€‚

ifçš„æ¡ä»¶è¡¨è¾¾å¼å¿…é¡»æ˜¯ä¸€ä¸ª`bool`ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¦åˆ™å°†æŠ¥é”™ï¼ˆ`mismatched types`ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´Rustä¸ä¼šè‡ªåŠ¨å°†ä¸€ä¸ªé`bool`ç±»å‹è¡¨è¾¾å¼è½¬æ¢æˆä¸€ä¸ª`bool`ï¼Œå¿…é¡»æ˜¾å¼åœ°ä¼ å…¥ä¸€ä¸ª`bool`ä½œä¸ºæ¡ä»¶è¡¨è¾¾å¼ã€‚

ä¸‹é¢çš„ä»£ç å°†æŠ¥é”™ï¼š

```rust
fn main() {
    let x = 10;
    if x {
        println!("Test no-Boolean in if.");
    }
}
```

å¯ä»¥è¿™æ ·åšä¿®æ”¹ï¼š

```rust
fn main() {
    let x = 10;
    if x != 0 {
        println!("Test no-Boolean in if.");
    }
}
```



#### 5.2 ç”¨else ifå¤„ç†å¤šåˆ†æ”¯

```rust
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}

```

é™¤äº†ä¸ç”¨å°æ‹¬å·æ¥åŒ…è£¹æ¡ä»¶è¡¨è¾¾å¼ï¼Œå…¶ä»–å’ŒC++å·®ä¸å¤šï¼

å¦‚æœä»£ç ä¸­æœ‰å¤ªå¤šçš„`else if`ï¼Œå¯ä»¥ä½¿ç”¨`match`è¡¨è¾¾å¼è¿›è¡Œé‡æ„ï¼Œåœ¨ç¬¬6ç« ä¼šè¯¦ç»†æè¿°ã€‚



#### 5.3 åœ¨`let`å£°æ˜ä¸­ä½¿ç”¨`if`

ç”±äº`if`æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä½œ`let`çš„å³å€¼ã€‚

```rust
fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {}", number);
}

```

ç±»ä¼¼äºä¸‰ç›®è¡¨è¾¾å¼ï¼Œ`if`è¡¨è¾¾å¼çš„è¿”å›å€¼å°±æ˜¯`{}`ä»£ç å—çš„è¿”å›å€¼ã€‚

å’ŒPythonçš„å†™æ³•å¾ˆåƒï¼š

```python
condition = True
number = 5 if condition else 6
```

ç”±äº`if`å¯èƒ½ä¼šæœ‰å¤šä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥è¿”å›å€¼å¯èƒ½åœ¨å¤šä¸ªåˆ†æ”¯ä¸­å†³å®šï¼Œéœ€è¦å¤šä¸ªåˆ†æ”¯ä¸­çš„è¿”å›å€¼ç±»å‹ç›¸åŒã€‚å¦åˆ™å°±ä¼šæŠ¥é”™ï¼š`if and else have incompatible types`ã€‚

Rustçš„ç¼–è¯‘å™¨éœ€è¦åœ¨ç¼–è¯‘æœŸå°±çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ï¼Œå› æ­¤å®ƒå¯ä»¥æ£€æŸ¥è¿™ä¸ªå˜é‡çš„ç±»å‹åœ¨æ‰€æœ‰åœ°æ–¹éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚æ‰€ä»¥ä¸å…è®¸åœ¨è¿è¡ŒæœŸæŒ‡å®šå˜é‡çš„ç±»å‹ã€‚



### 6 å¾ªç¯

Rustæœ‰ä¸‰ç§å¾ªç¯ï¼š`loop` `while` `for`

#### 6.1 `loop`å¾ªç¯

```rust
fn main() {
    loop {
        println!("again!");
    }
}

```

è¿™æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œåªèƒ½é€šè¿‡`Ctrl+C`é€€å‡ºã€‚

`loop`å®šä¹‰çš„å¾ªç¯ä¹Ÿå¯ä»¥é€šè¿‡`break`å…³é”®å­—é€€å‡ºã€‚



#### 6.2 ä»å¾ªç¯ä¸­è¿”å›å€¼

æœ‰ä¸€ç§ä½¿ç”¨å¾ªç¯çš„ç›®çš„æ˜¯ç”¨æ¥é‡å¤æµ‹è¯•ä¸€ä¸ªå¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œï¼Œæ¯”å¦‚æµ‹è¯•ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å®Œæˆäº†å®ƒçš„å·¥ä½œã€‚è¿™å°±éœ€è¦è·å¾—å¾ªç¯çš„è¿”å›å€¼ã€‚

å¯ä»¥é€šè¿‡å°†è¦è¿”å›çš„å€¼æ”¾åœ¨`break`å…³é”®å­—åé¢æ¥åœæ­¢ä¸€ä¸ªå¾ªç¯åŒæ—¶è¿”å›è¿™ä¸ªå€¼ã€‚

```rust
fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {}", result);
}

```



#### 6.3 `while`æ¡ä»¶å¾ªç¯

```rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{}!", number);

        number -= 1;
    }

    println!("LIFTOFF!!!");
}

```

å½“`while`åçš„è¡¨è¾¾å¼ä¸º`true`æ—¶å°±æŒç»­å¾ªç¯ã€‚



#### 6.4 ä½¿ç”¨`for`éå†ä¸€ä¸ªé›†åˆ

ä½¿ç”¨`while`ä¹Ÿå¯ä»¥éå†ï¼š

```rust
let a = [10, 20, 30, 40, 50];
let mut index = 0;
while index < 5 {
    println!("a[{}] is: {}", index, a[index]);

    index += 1;
}
```

ä½†æ˜¯å’±é€‰æ‹©æ›´å¥½çš„`for`ï¼š

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a.iter() {
        println!("the value is: {}", element);
    }
}

```

æ²¡æœ‰äº†è¿è¡Œæ—¶æ¯æ¬¡å¾ªç¯çš„æ¡ä»¶æ£€æŸ¥ï¼Œç¨‹åºä¼šè·‘çš„æ›´å¿«ï¼ŒåŒæ—¶ä¹Ÿä¸ç”¨æ‹…å¿ƒç”±äº`index`å‡ºé”™å¯¼è‡´ç¨‹åºå‡ºé”™ã€‚

å®‰å…¨æ€§å’Œç®€æ´æ€§è®©`for`å¾ªç¯æˆä¸ºRustä¸­æœ€å¸¸ç”¨çš„å¾ªç¯ã€‚å³ä½¿æ˜¯ç±»ä¼¼äº6.3ä¸­çš„å€’æ•°è¿™æ ·çš„åŠŸèƒ½ï¼Œå¤§éƒ¨åˆ†Rustaceansä¹Ÿä¼šä½¿ç”¨`for`æ¥å†™ã€‚æ–¹æ³•æ˜¯é€šè¿‡ä½¿ç”¨`Range`è¡¨è¾¾å¼ã€‚

`Range`è¡¨è¾¾å¼æ˜¯æ ‡å‡†åº“ä¸­æä¾›çš„ï¼Œç”¨äºç”Ÿæˆä¸€ç³»åˆ—æ•°å­—ã€‚

```rust
fn main() {
    for number in (1..4).rev() {
        println!("{}!", number);
    }
    println!("LIFTOFF!!!");
}

```

ä¸Šé¢çš„ä»£ç ç”¨äºä»3å€’æ•°åˆ°1ï¼Œ`.rev`æ–¹æ³•ç”¨äºå°†ä¸€ä¸ª`Range`åè½¬ã€‚



### Practices

ä¹¦ä¸­ç•™ä¸‹äº†å‡ ä¸ªç»ƒä¹ é¢˜ï¼š

> 1. Convert temperatures between Fahrenheit and Celsius.
> 2. Generate the nth Fibonacci number.
> 3. Print the lyrics to the Christmas carol â€œThe Twelve Days of Christmas,â€ taking advantage of the repetition in the song.



#### 1. è½¬æ¢åæ°åº¦å’Œæ‘„æ°åº¦

åæ°åº¦å’Œæ‘„æ°åº¦çš„å…³ç³»ï¼š`åæ°åº¦ = 32 + æ‘„æ°åº¦ * 1.8`

```rust
use std::io;
fn main() {
    loop {
        let mut degree = String::new();
        let mut convert_flag = String::new();
        println!("What would you want to convert?");
        println!("  1. CÂ° --> FÂ°");
        println!("  2. FÂ° --> CÂ°");
        println!("  0. exit");
        println!("Please input your choice:(tap enter to confirm)");

        io::stdin()
            .read_line(&mut convert_flag)
            .expect("Error in read_line");

        let convert_flag: u32 = convert_flag.trim().parse()
            .expect("Please input a valid number");

        if convert_flag == 1 {
            println!("Please input a Celsius degree: ");
            io::stdin()
                .read_line(&mut degree)
                .expect("Error read_line");
            let degree: f64 = degree.trim().parse()
                .expect("Please input a number");
            println!("{} CÂ° is {} FÂ°.", degree, convert_c2f(degree)); 
        } else if convert_flag == 2 {
            println!("Please input a Fahrenheit degree: ");
            io::stdin()
                .read_line(&mut degree)
                .expect("Error read_line");
            let degree: f64 = degree.trim().parse()
                .expect("Please input a number");
            println!("{} FÂ° is {} FC.", degree, convert_f2c(degree)); 
        } else if convert_flag == 0 {
            break;
        } else {
            println!("Please input a valid choice!");
        }
    }
}

fn convert_f2c(f: f64) -> f64 {
    (f - 32.0) / 1.8
}

fn convert_c2f(c: f64) -> f64 {
    32.0 + c * 1.8
}
```

![image-20210905200207038]({{ site.url }}/imgs/rust/3_common_programming_concepts/01_practice1.png)



#### 2. ç”Ÿæˆç¬¬nä¸ªæ–æ³¢é‚£å¥‘æ•°

ç®€å•å®ç°ä¸€ä¸‹ï¼Œä¸è¦ç”¨ä½æ•ˆçš„é€’å½’ã€‚

```rust
use std::io;

fn main() {
    loop {
        println!("Which fibonacci you want? (0 to exit)");
        let mut number = String::new();

        io::stdin()
            .read_line(&mut number)
            .expect("Error read_line n");

        let number: u32 = number.trim().parse()
            .expect("Please input a valid interger!");
        
        if number == 0 {
            break;
        }

        println!("{}th fibonacci is {}", number, fibonacci(number));
    }
}

fn fibonacci(n: u32) -> u32 {
    if n == 1 || n == 2 {
        return 1;
    } else if n == 3 {
        return 2;
    }

    let mut x0: u32 = 1;
    let mut result: u32 = 2;
    for _ in 4..=n {
        let tmp = result;
        result = x0 + result;
        x0 = tmp;
    }

    result
}

```

![image-20210905202340953]({{ site.url }}/imgs/rust/3_common_programming_concepts/01_practice2.png)



#### 3. ç”¨å¾ªç¯æ‰“å°æ­Œè¯

å…ˆæ‰¾ä¸€ä¸‹æ­Œè¯ï¼š

```
The Twelve days of Christmas. On the first day of Christmas, my true love sent to me: A partridge in a pear tree.
On the second day of Christmas, my true love sent to me: Two turtle doves, And a partridge in a pear tree.
On the third day of Christmas, my true love sent to me: Three French hens, Two turtle doves, And a partridge in a pear tree.
On the fourth day of Christmas, my true love sent to me: Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the fifth day of Christmas, my true love sent to me: Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the sixth day of Christmas, my true love sent to me: Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the seventh day of Christmas, my true love sent to me: Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the eighth day of Christmas, my true love sent to me: Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the ninth day of Christmas, my true love sent to me: Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the tenth day of Christmas, my true love sent to me: Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.
On the eleventh day of Christmas, my true love sent to me: Eleven pipers piping, Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves,And a partridge in a pear tree.
On the twelfth day of Christmas, my true love sent to me: Twelve drummers drumming, Eleven pipers piping, Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings, Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree!
```

æ”¾åœ¨æ•°ç»„é‡Œç„¶åéå†ï¼š

```rust
fn main() {
    let lyrics = [
        "The Twelve days of Christmas. On the first day of Christmas, my true love sent to me: A partridge in a pear tree.",
        "On the second day of Christmas, my true love sent to me: Two turtle doves, And a partridge in a pear tree.",
        "On the third day of Christmas, my true love sent to me: Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the fourth day of Christmas, my true love sent to me: Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the fifth day of Christmas, my true love sent to me: Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the sixth day of Christmas, my true love sent to me: Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the seventh day of Christmas, my true love sent to me: Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the eighth day of Christmas, my true love sent to me: Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the ninth day of Christmas, my true love sent to me: Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the tenth day of Christmas, my true love sent to me: Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree.",
        "On the eleventh day of Christmas, my true love sent to me: Eleven pipers piping, Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings; Four calling birds, Three French hens, Two turtle doves,And a partridge in a pear tree.",
        "On the twelfth day of Christmas, my true love sent to me: Twelve drummers drumming, Eleven pipers piping, Ten lords a-leaping, Nine ladies dancing, Eight maids a-milking, Seven swans a-swimming, Six geese a-laying, Five golden rings, Four calling birds, Three French hens, Two turtle doves, And a partridge in a pear tree!"
    ];

    for line in lyrics {
        println!("{}", line);
        println!("");
    }
}
```

![image-20210905203143732]({{ site.url }}/imgs/rust/3_common_programming_concepts/01_practice3.png)



---

[Return to Top](#Top)

